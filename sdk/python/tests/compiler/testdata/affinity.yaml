apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: sleep
spec:
  steps:
  - command:
    - sleep 1
    image: busybox
    name: sleep
---
apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  annotations:
    pipelines.kubeflow.org/pipeline_spec: '{"description": "A pipeline with affinity",
      "name": "affinity"}'
    sidecar.istio.io/inject: 'false'
  name: affinity
spec:
  params: []
  tasks:
  - name: sleep
    params: []
    taskRef:
      name: sleep
---
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: affinity-run
spec:
  params: []
  pipelineRef:
    name: affinity
  taskRunSpec:
  - pipelineTaskName: sleep
    taskPodTemplate:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: beta.kubernetes.io/instance-type
                operator: In
                values:
                - p2.xlarge
